# 网络协议栈技术现状分享

​	本节向读者介绍网络协议栈的可用协议和架构的分析。目标是提供推断结论的基础和理解为什么libp2p满足它的要求和体系架构。

## 客户端-服务器模型

​	CS模型表示在信道两端的双方具有不同的角色，它们具有不同服务和不同的处理能力，换句话说，它们有不同的协议。

​	构建CS模型的应用程序时一种自然趋势，原因有很多：

- 数据中心的带宽远远高于客户端彼此连接可利用的带宽；

- 数据中心资源是相当便宜的，因为可以高效的使用和大量库存；

- 它使开发人员和系统管理员更容易对应用程序进行细粒度的控制；

- 它减少了处理异构系统的数量 (虽然现在数量仍然很大);

- 像NAT这样的系统使客户端机器很难互相发现和互相通信，迫使开发人员使用高超的黑客技术来穿越这些障碍；

- 开始设计协议时假设开发人员从一开始就创建了CS模型的应用程序。

  我们甚至学会了如何使用执行点对点的操作的协议(例如HTTP)来隐藏在Internet网关后所有分布式系统的复杂性，在查看和理解每个请求进行级联服务调用时，使得应用程序不透明。

  libp2p提供了一种从客户端-服务端CS监听器向拨号器侦听器dialer-listener交互的方法，其中不隐含哪些实体、拨号器或侦听器具有哪些能力或能够执行哪些操作。如今在两个应用程序之间建立连接是一个需要解决的多层问题，这些连接不应该有目的偏差，而是在已建立连接基础上应该支持其它协议的使用。在CS模型中，在没有来自客户端先请求的情况下服务端发送数据被称为push(推送)模型，其增加了更多的复杂性；相比较，在dialer-listener(拨号器-侦听器)中，两个实体可以独立的执行请求。

## 通过解决方案对网络堆栈协议进行分类

​	在深入研究libp2p协议之前，了解已广泛使用和部署的大量协议非常重要，这有助于维护当今简单的抽象。例如，当人们考虑HTTP连接时，人们可能会天真地认为HTTP / TCP / IP是所涉及的主要协议，但实际上有更多协议参与，具体取决于使用情况，涉及的网络等等。像DNS，DHCP（v6），ARP，NDISC，OSPF，以太网，802.11（Wi-Fi）等许多协议都被涉及到。查看ISP内部网络将会发现更多。

​	此外，值得注意的是传统的7层OSI模型特征不适合libp2p。相反，我们根据角色对协议进行分类，即它们解决的问题。OSI模型的上层面向应用程序之间的点对点链路，而 libp2p 协议在各种不同的安全模型下更倾向于具有不同功能属性的网络，不同大小的网络。不同的libp2p协议可以具有相同的角色（在OSI模型中，这将是“地址相同的层”），这意味着多个协议可以同时运行，所有这些都解决了一个角色（而不是传统OSI协议栈中的每层）。例如，引导列表，mDNS，DHT发现和PEX都是“对等发现”角色的所有形式;它们可以共存甚至协同作用。

### 建立物理链接

- Ethernet
- Wi-Fi
- Bluetooth
- USB

### 寻址机器或过程

- IPv4
- IPv6
- Hidden addressing, like SDP

### 发现其他对等体或服务

- ARP
- NDISC
- DHCP(v6)
- DNS
- Onion

### 通过网络路由消息

- RIP(1, 2)
- OSPF
- BGP
- PPP
- Tor
- I2P
- cjdns

### 传输方式

- TCP
- UDP
- UDT
- QUIC
- WebRTC data channel

###  **应用程序之间协商一致的通信语义**

- RMI
- Remoting
- RPC
- HTTP

## 目前的缺点

​	虽然我们目前有一整套可用于我们服务的协议进行通信，丰富多样的解决方案会产生自己的问题。

​	虽然我们目前有一系列的协议可供我们的服务进行通信，但解决方案的丰富性和多样性也产生了自身的问题。目前，应用程序难在少数几种传输中（例如，在浏览器应用程序中缺少TCP/UDP栈）得到支持和使用。

​	也没有“存在链接”，这意味着对等体没有在少数几种传输中宣布自己的概念，因此其他对等体可以保证它始终是同一个对等体。